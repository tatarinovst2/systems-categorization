# Классификация суицидальных текстов с помощью нейросетевых технологий

## Данные

За основу разработки алгоритма для классификации брался датасет с платформы Kaggle. 
Данный датасет вы можете найти [тут](https://www.kaggle.com/datasets/nikhileswarkomati/suicide-watch)

**Исходный датасет содержит:**

1. 232 074 текстов (содержаться в колонке text), 166.9 MB;
2. Каждый текст имеет метку “suicide” либо “non-suicide” (содержаться 
   в колонке class).

Датасет сбалансированный и не содержит дубликатов и значений NaN.
Тексты не лемматизированы, не токенизированы.

Для дальнейшей работы необходимо преобразовать тексты.

## Этап I: работа с текстом

### Шаг 1: Уменьшение количества данных

Для более быстрого обучения моделей классификации из 232 074 текстов оставлены 
30 000 текстов

### Шаг 2: Препроцессинг текстов

**Текст:**

* Тексты очищаются от ссылок и от всех символов, кроме букв, цифр и пробельных 
  символов, с помощью регулярных выражений;
* Тексты приводятся к нижнему регистру;
* Кодируются лейблы (“non-suicide” как 0, “suicide” как 1).

### Шаг 3: Токенизация текстов

В данной работы мы сравнивали несколько способов токенизации. Мы использовали 
следующими инструменты:

* Razdel
* Регулярные выражения
* Bert
* NLTK

Однако для дальнейшей работы был выбран NLTK токенизатор, так как именно 
данный инструмент совершил наименьшее количество ошибок на данном наборе текстов.

### Шаг 4: Лемматизация текстов

Для лемматизация, как и для токенизации, мы использовали несколько инструментов:
* Simplemma
* Spacy

Далее мы используем результат работы Spacy, так как данная библиотека наиболее 
точно лемматицировала тексты.

### Шаг 5: Векторизация 

Векторизация производилась с помощью Tf-Idf векторизатора.

## Этап II: алгоритм тематического моделирования

### Шаг 6: Тематическое моделирование

Тематическое моделирование производилось 4 способами:
* NMF
* Gensim LDA
* LDA
* LDA ARTM

Алгоритм LDA ARTM наиболее точно разделил тексты на 4 группы. Однако для того, 
чтобы создать классификатор, позволяющий определять тематику суицидных текстов, 
необходимо конкретизировать и расширить некоторые темы. Для этого необходимо 
произвести ручную корректировку.

## Этап III: разметка

### Шаг 7: Разметка данных

В результате дополнительной разметки данных, каждому тексту была присвоена 
одна из следующих меток:

`1` - просьбы о помощи, просьбы поговорить;
`4` - ненависть к себе, собственная ущербность, неполноценность;
`5` - психические заболевания;
`6` - наркотики, алкоголь, зависимости;
`7` - семья;
`8` - любовь, отношения;
`9` - учёба, работа;
`10` - самоповреждения, анорексия, булимия/

## Этап IV: нейронная сеть

### Шаг 8: Подготовка данных к обучению

На данном шаге необходимо сделать следующие действия:

1. Очистить тексты
2. Тонизировать тексты
3. Удалить стоп сова
4. Лемматизировать тексты
5. Векторизовать тексты

### Шаг 9: Обучение модели бинарной классификации 

Модель написана с использованием библиотеки `PyTorch`. 

В модели 3 слоя:

* первый слой содержит 64 нейрона, в качестве функции активации используется функция ReLU
* второй слой содержит 32 нейрона, в качестве функции активации используется функция ReLU
* на выходном слое используется функция активации Sigmoid

Точность данной модели - **92%**

### Шаг 10: Подготовка данных к обучению модели мультиклассовой классификации

Данная модель также написана на `PyTorch` и имеет 3 слоя:

* первый слой содержит 64 нейрона, в качестве функции активации используется функция ReLU
* второй слой содержит 32 нейрона, в качестве функции активации используется функция ReLU
* на выходном слое мы получаем 8 меток классов

Точность данной модели - **53%**

## Где можно посмотреть результаты работы?

Вы можете посмотреть результаты нашей работы в открытом репозитории на 
[Github](https://github.com/tatarinovst2/systems-categorization).

Вы также можете клонировать наш репозиторий для локальной работы и предложить 
нам свои улучшения. Для работы вам необходимо скачать либо исходный датасет 
с платформы Kaggle, либо воспользоваться подготовленным нами датасетом 
([скачать здесь](https://github.com/tatarinovst2/systems-categorization/blob/main/Suicide_Detection_30000.csv)
для тематического моделирования и бинарной классификации, 
[скачать здесь](https://github.com/tatarinovst2/systems-categorization/blob/main/Suicide_Detection_with_topics_balanced.csv)
для мультиклассовой классификации).

Мы будем рады увидеть ваши улучшения в pull requests!